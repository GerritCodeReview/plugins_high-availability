{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "8f57af50_8c470473",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1127770
      },
      "writtenOn": "2021-10-13T18:32:19Z",
      "side": 1,
      "message": "Hi I try to verify change but I get errors:\n\ngerrit-02_1       | Couldn\u0027t upgrade schema. Expected if slave and read-only database\ngerrit-02_1       | ERROR com.google.gerrit.pgm.init.BaseInit : Couldn\u0027t upgrade schema. Expected if slave and read-only database\ngerrit-02_1       | com.google.gerrit.exceptions.StorageException: Cannot initialize Gerrit site\n\n\nand \ngerrit-01_1       | [2021-10-13 17:41:35,708] [main] ERROR com.google.gerrit.server.index.account.AllAccountsIndexer : Error collecting accounts\ngerrit-01_1       | org.eclipse.jgit.errors.RepositoryNotFoundException: repository not found: Cannot open repository All-Users\n\nThere are also other problems during docker-compose build, did You verify this change what I miss?\n",
      "revId": "a407d6c6f99514ecea70fc96530faf6321ecf74d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c058700c_a8341b6a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1083195
      },
      "writtenOn": "2021-10-25T14:26:17Z",
      "side": 1,
      "message": "I was also getting these lines, @Luca, can you tell us what is the cause?",
      "parentUuid": "8f57af50_8c470473",
      "revId": "a407d6c6f99514ecea70fc96530faf6321ecf74d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5572e5f1_2f8f8b20",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-10-25T19:07:53Z",
      "side": 1,
      "message": "This works E2E for me. Are you starting with a fresh environment or using an existing one?",
      "parentUuid": "c058700c_a8341b6a",
      "revId": "a407d6c6f99514ecea70fc96530faf6321ecf74d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9b9330bf_31a2ca81",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1083195
      },
      "writtenOn": "2021-10-26T02:19:53Z",
      "side": 1,
      "message": "I used docker-compose in my dev environment. It had problems to properly start.",
      "parentUuid": "5572e5f1_2f8f8b20",
      "revId": "a407d6c6f99514ecea70fc96530faf6321ecf74d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5965a7de_b5099b37",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-10-26T07:56:31Z",
      "side": 1,
      "message": "does your environment work before this change?",
      "parentUuid": "9b9330bf_31a2ca81",
      "revId": "a407d6c6f99514ecea70fc96530faf6321ecf74d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c377f9bb_b87785a4",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1127770
      },
      "writtenOn": "2021-10-28T12:59:59Z",
      "side": 1,
      "message": "HI I try this 1st time. It is on 3.1 and 3.2. But on 3.3 it is not starting. It also requires to modify some files to pass docker-compose build.\nI manage to run docker with some problems (only 1 node is working) and I spotted that gerrit version used in this change is 3.2.10. I think this is mistake and we should use 3.3 in this tests. Please confirm may be this is a root cause of problems",
      "parentUuid": "5965a7de_b5099b37",
      "revId": "a407d6c6f99514ecea70fc96530faf6321ecf74d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ecaec05a_af5a66bb",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-10-28T20:02:22Z",
      "side": 1,
      "message": "\u003e HI I try this 1st time. It is on 3.1 and 3.2.\n\nWhat do you mean is on 3.1 and 3.2? *Before* this change it should be on v3.2.10\n\n\u003e But on 3.3 it is not starting. It also requires to modify some files to pass docker-compose build.\n\nNo, it shouldn\u0027t. \n\nSee what I did:\n$ git clone https://gerrit.googlesource.com/plugins/high-availability\n$ git fetch https://gerrit.googlesource.com/plugins/high-availability refs/changes/83/317883/2 \u0026\u0026 git checkout FETCH_HEAD\n$ cd high-availability/src/test/docker\n$ docker-compose build\n$ docker-compose up\n\nThe docker-compose up will:\n- start syslog-sidecar\n- start haproxy\n- start gerrit-01\n- start gerrit-02\n\n\u003e I manage to run docker with some problems (only 1 node is working) and I spotted that gerrit version used in this change is 3.2.10.\n\nThen, there must be something strange going on in your setup: *after this change* the gerrit version should be 3.3.6. Have you run \u0027docker-compose build\u0027 after fetching the change?\n\n\u003e I think this is mistake and we should use 3.3 in this tests. \n\nWhich tests? This is just a docker-compose environment without tests: what tests are you referring to?\n\n\u003e Please confirm may be this is a root cause of problems\n\nI have no idea yet of what is the issue on your side: can you record a short video of what you are doing and share it?",
      "parentUuid": "c377f9bb_b87785a4",
      "revId": "a407d6c6f99514ecea70fc96530faf6321ecf74d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e3e9fd35_9bc6d211",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1127770
      },
      "writtenOn": "2021-10-29T17:12:34Z",
      "side": 1,
      "message": "Hi I did:\n1. git clone https://gerrit.googlesource.com/plugins/high-availability\n2. cd high-availability/\n3. git fetch https://gerrit.googlesource.com/plugins/high-availability refs/changes/83/317883/2 \u0026\u0026 git checkout FETCH_HEAD\n4. cd src/test/docker/\n5. docker-compose build\n\nError spotted:\n\"mkdir: cannot create directory \u0027/var/lib/haproxy\u0027: File exists\nERROR: Service \u0027haproxy\u0027 failed to build: The command \u0027/bin/sh -c mkdir /var/lib/haproxy \u0026\u0026     mkdir /var/run/haproxy \u0026\u0026     useradd haproxy \u0026\u0026     chown haproxy: /var/lib/haproxy /var/run/haproxy\u0027 returned a non-zero code: 1\"\n\n6 vim haproxy/Dockerfile\nAnd add to mkdir -p flag\n\n7.docker-compose build\nERROR: \"useradd: user \u0027haproxy\u0027 already exists\"\n\n8. vim haproxy/Dockerfile\n  Remove useradd line 7\n9. docker-compose build\n \"Successfully built 7a935dfa5e85\n Successfully tagged docker_syslog-sidecar:latest\"\n\n10. docker-compose up\n\tDocker is starting:\n\tCreating docker_syslog-sidecar_1 ... done\n\tCreating docker_gerrit-01_1      ... done\n\tCreating docker_gerrit-02_1      ... done\n\tCreating docker_haproxy_1        ... done\n\t\n\tAnd then\n\tgerrit-01_1       | ERROR com.google.gerrit.pgm.init.BaseInit : Couldn\u0027t upgrade schema. Expected if slave and read- only database\n\tgerrit-01_1       | com.google.gerrit.exceptions.StorageException: Cannot initialize Gerrit site\n\tdocker_gerrit-01_1 exited with code 1\n\t\nToday I created fresh ubuntu 20.04 lts on virtual box. I install docker+ bazylisk + java openjdk 11.0.11 2021-04-20, result above.",
      "parentUuid": "ecaec05a_af5a66bb",
      "revId": "a407d6c6f99514ecea70fc96530faf6321ecf74d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}