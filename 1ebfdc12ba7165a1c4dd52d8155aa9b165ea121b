{
  "comments": [
    {
      "key": {
        "uuid": "0464125d_9291b2a7",
        "filename": "src/main/java/com/ericsson/gerrit/plugins/highavailability/forwarder/rest/IndexAccountRestApiServlet.java",
        "patchSetId": 2
      },
      "lineNbr": 30,
      "author": {
        "id": 1012987
      },
      "writtenOn": "2018-03-20T16:28:23Z",
      "side": 1,
      "message": "I am not sure this is a good idea. Won\u0027t this replace the encoder configured by the core in Gerrit.java?\n\nKeyUtil.setEncoderImpl(\n        new KeyUtil.Encoder() {\n          @Override\n          public String encode(String e) {\n            e \u003d URL.encodeQueryString(e);\n            e \u003d fixPathImpl(e);\n            e \u003d fixColonImpl(e);\n            e \u003d fixDoubleQuote(e);\n            return e;\n          }\n\n          @Override\n          public String decode(final String e) {\n            return URL.decodeQueryString(e);\n          }\n\n          private native String fixPathImpl(String path)\n              /*-{ return path.replace(/%2F/g, \"/\"); }-*/ ;\n\n          private native String fixColonImpl(String path)\n              /*-{ return path.replace(/%3A/g, \":\"); }-*/ ;\n\n          private native String fixDoubleQuote(String path)\n              /*-{ return path.replace(/%22/g, \u0027\"\u0027); }-*/ ;\n        });",
      "range": {
        "startLine": 28,
        "startChar": 1,
        "endLine": 30,
        "endChar": 3
      },
      "revId": "1ebfdc12ba7165a1c4dd52d8155aa9b165ea121b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4a262b74_4537ea86",
        "filename": "src/main/java/com/ericsson/gerrit/plugins/highavailability/forwarder/rest/IndexAccountRestApiServlet.java",
        "patchSetId": 2
      },
      "lineNbr": 30,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2018-03-20T16:30:48Z",
      "side": 1,
      "message": "Gerrit.java is GWT and is trans-compiled into  JavaScript. It won\u0027t be impacted at all by this plugin.",
      "parentUuid": "0464125d_9291b2a7",
      "range": {
        "startLine": 28,
        "startChar": 1,
        "endLine": 30,
        "endChar": 3
      },
      "revId": "1ebfdc12ba7165a1c4dd52d8155aa9b165ea121b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "26405c0f_2804624d",
        "filename": "src/main/java/com/ericsson/gerrit/plugins/highavailability/forwarder/rest/IndexAccountRestApiServlet.java",
        "patchSetId": 2
      },
      "lineNbr": 30,
      "author": {
        "id": 1012987
      },
      "writtenOn": "2018-03-20T16:34:03Z",
      "side": 1,
      "message": "Good point!\n\nBut still, at runtime, we do not need to set this for high-availability plugin to work which means that encoder is already set to something. This will replace it because encoder is a static variable. I do not think we should replaced the encoder from a plugin.",
      "parentUuid": "4a262b74_4537ea86",
      "range": {
        "startLine": 28,
        "startChar": 1,
        "endLine": 30,
        "endChar": 3
      },
      "revId": "1ebfdc12ba7165a1c4dd52d8155aa9b165ea121b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f49375db_ea0c56ae",
        "filename": "src/main/java/com/ericsson/gerrit/plugins/highavailability/forwarder/rest/IndexAccountRestApiServlet.java",
        "patchSetId": 2
      },
      "lineNbr": 30,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2018-03-20T16:36:21Z",
      "side": 1,
      "message": "I agree with Hugo. Setting encoder explicitly should only be done from testing code.",
      "parentUuid": "26405c0f_2804624d",
      "range": {
        "startLine": 28,
        "startChar": 1,
        "endLine": 30,
        "endChar": 3
      },
      "revId": "1ebfdc12ba7165a1c4dd52d8155aa9b165ea121b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "67ba78b5_8405fb51",
        "filename": "src/main/java/com/ericsson/gerrit/plugins/highavailability/forwarder/rest/IndexAccountRestApiServlet.java",
        "patchSetId": 2
      },
      "lineNbr": 30,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2018-03-20T16:37:37Z",
      "side": 1,
      "message": "Gerrit does not set the encoderImpl in the backend but it is implicitly done in GWTORM when the DB is getting opened. When we\u0027ll not open the DB anymore, that would fail with NPE.\n\nWe could just make a static reference to DB and trigger the static block evaluation, so that it will be made only once.",
      "parentUuid": "26405c0f_2804624d",
      "range": {
        "startLine": 28,
        "startChar": 1,
        "endLine": 30,
        "endChar": 3
      },
      "revId": "1ebfdc12ba7165a1c4dd52d8155aa9b165ea121b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}